diff --git a/CMakeLists.txt b/CMakeLists.txt
index 15e5ec9..c7ac65a 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -48,6 +48,8 @@ set(PACKAGE_TARNAME   "${PACKAGE_NAME}-${PACKAGE_VERSION}")
 set(PACKAGE_BUGREPORT "https://github.com/grpc/grpc/issues/")
 project(${PACKAGE_NAME} C CXX)
 
+include(CheckFunctionExists)
+
 set(gRPC_ZLIB_PROVIDER "module" CACHE STRING "Provider of zlib library")
 set_property(CACHE gRPC_ZLIB_PROVIDER PROPERTY STRINGS "module" "package")
 
@@ -66,6 +68,13 @@ else()
   set(_gRPC_PROTOBUF_LIBRARY_NAME "libprotobuf")
 endif()
 
+CHECK_FUNCTION_EXISTS(pow RESULT)
+if(NOT RESULT)
+  unset(RESULT)
+  set(_libMath "m")
+endif()
+
+
 if("${gRPC_ZLIB_PROVIDER}" STREQUAL "module")
   if(NOT ZLIB_ROOT_DIR)
     set(ZLIB_ROOT_DIR ${CMAKE_CURRENT_SOURCE_DIR}/third_party/zlib)
@@ -109,18 +118,23 @@ if("${gRPC_PROTOBUF_PROVIDER}" STREQUAL "module")
       message(WARNING "gRPC_PROTOBUF_PROVIDER is \"module\" but PROTOBUF_ROOT_DIR is wrong")
   endif()
 elseif("${gRPC_PROTOBUF_PROVIDER}" STREQUAL "package")
-  find_package(protobuf CONFIG)
-  if(protobuf_FOUND)
-    if(TARGET protobuf::${_gRPC_PROTOBUF_LIBRARY_NAME})
-      set(_gRPC_PROTOBUF_LIBRARIES protobuf::${_gRPC_PROTOBUF_LIBRARY_NAME})
-    endif()
-    if(TARGET protobuf::libprotoc)
-      set(_gRPC_PROTOBUF_PROTOC_LIBRARIES protobuf::libprotoc)
-    endif()
-    set(_gRPC_FIND_PROTOBUF "if(NOT protobuf_FOUND)\n  find_package(protobuf CONFIG)\nendif()")
+  find_package(Protobuf)
+  if(Protobuf_FOUND)
+      set(_gRPC_PROTOBUF_LIBRARIES "${Protobuf_LIBRARIES}")
+      set(_gRPC_PROTOBUF_PROTOC_LIBRARIES "${Protobuf_PROTOC_LIBRARIES}")
   else()
-    find_package(Protobuf MODULE)
-    set(_gRPC_FIND_PROTOBUF "if(NOT Protobuf_FOUND)\n  find_package(Protobuf)\nendif()")
+        find_package(protobuf CONFIG)
+        if(protobuf_FOUND)
+            if(TARGET protobuf::${_gRPC_PROTOBUF_LIBRARY_NAME})
+                set(_gRPC_PROTOBUF_LIBRARIES protobuf::${_gRPC_PROTOBUF_LIBRARY_NAME})
+            endif()
+            if(TARGET protobuf::libprotoc)
+                set(_gRPC_PROTOBUF_PROTOC_LIBRARIES protobuf::libprotoc)
+            endif()
+            set(_gRPC_FIND_PROTOBUF "if(NOT protobuf_FOUND)\n  find_package(protobuf CONFIG)\nendif()")
+        else()
+            set(_gRPC_FIND_PROTOBUF "if(NOT Protobuf_FOUND)\n  find_package(Protobuf)\nendif()")
+        endif()
   endif()
 endif()
 
@@ -216,6 +230,9 @@ target_include_directories(gpr
   PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/third_party/zlib
 )
 
+target_link_libraries(gpr
+  ${_libMath}
+)
 
 foreach(_hdr
   include/grpc/support/alloc.h
@@ -712,6 +729,7 @@ target_link_libraries(grpc_cronet
   ${_gRPC_BASELIB_LIBRARIES}
   ${_gRPC_SSL_LIBRARIES}
   gpr
+  ${_libMath}
 )
 
 foreach(_hdr
@@ -937,6 +955,7 @@ target_include_directories(grpc_unsecure
 target_link_libraries(grpc_unsecure
   ${_gRPC_BASELIB_LIBRARIES}
   gpr
+  ${_libMath}
 )
 
 foreach(_hdr
@@ -1292,6 +1311,7 @@ target_link_libraries(grpc++_unsecure
   gpr
   grpc_unsecure
   grpc
+  ${_libMath}
 )
 
 foreach(_hdr
@@ -1465,6 +1485,7 @@ target_include_directories(grpc_csharp_ext
 target_link_libraries(grpc_csharp_ext
   grpc
   gpr
+  ${_libMath}
 )
 
 
@@ -1493,6 +1514,7 @@ target_include_directories(gen_hpack_tables
 target_link_libraries(gen_hpack_tables
   gpr
   grpc
+  ${_gRPC_PROTOBUF_LIBRARIES}
 )
 
 
@@ -1542,6 +1564,7 @@ target_link_libraries(grpc_create_jwt
   ${_gRPC_SSL_LIBRARIES}
   grpc
   gpr
+  ${_gRPC_PROTOBUF_LIBRARIES}
 )
 
 
@@ -1568,6 +1591,7 @@ target_include_directories(grpc_print_google_default_creds_token
 target_link_libraries(grpc_print_google_default_creds_token
   grpc
   gpr
+  ${_gRPC_PROTOBUF_LIBRARIES}
 )
 
 
@@ -1594,6 +1618,7 @@ target_include_directories(grpc_verify_jwt
 target_link_libraries(grpc_verify_jwt
   grpc
   gpr
+  ${_gRPC_PROTOBUF_LIBRARIES}
 )
 
 
@@ -1618,6 +1643,7 @@ target_include_directories(grpc_cpp_plugin
 )
 
 target_link_libraries(grpc_cpp_plugin
+  ${_gRPC_PROTOBUF_LIBRARIES}
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
   grpc_plugin_support
 )
@@ -1644,6 +1670,7 @@ target_include_directories(grpc_csharp_plugin
 )
 
 target_link_libraries(grpc_csharp_plugin
+  ${_gRPC_PROTOBUF_LIBRARIES}
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
   grpc_plugin_support
 )
@@ -1670,6 +1697,7 @@ target_include_directories(grpc_node_plugin
 )
 
 target_link_libraries(grpc_node_plugin
+  ${_gRPC_PROTOBUF_LIBRARIES}
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
   grpc_plugin_support
 )
@@ -1697,6 +1725,7 @@ target_include_directories(grpc_objective_c_plugin
 
 target_link_libraries(grpc_objective_c_plugin
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
+  ${_gRPC_PROTOBUF_LIBRARIES}
   grpc_plugin_support
 )
 
@@ -1724,6 +1753,7 @@ target_include_directories(grpc_python_plugin
 target_link_libraries(grpc_python_plugin
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
   grpc_plugin_support
+  ${_gRPC_PROTOBUF_LIBRARIES}
 )
 
 
@@ -1748,6 +1778,7 @@ target_include_directories(grpc_ruby_plugin
 )
 
 target_link_libraries(grpc_ruby_plugin
+  ${_gRPC_PROTOBUF_LIBRARIES}
   ${_gRPC_PROTOBUF_PROTOC_LIBRARIES}
   grpc_plugin_support
 )
