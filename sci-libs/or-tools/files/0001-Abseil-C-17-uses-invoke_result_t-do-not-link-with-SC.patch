From 0e9b4c4f3746046f6d7ee1f885bed70b060a2149 Mon Sep 17 00:00:00 2001
From: Amit Prakash Ambasta <amit.prakash.ambasta@gmail.com>
Date: Thu, 8 Oct 2020 11:15:28 +0530
Subject: [PATCH] Abseil C++17 uses invoke_result_t, do not link with SCIP if
 DUSE_SCIP is off

---
 cmake/cpp.cmake        | 3 ++-
 ortools/base/cleanup.h | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/cmake/cpp.cmake b/cmake/cpp.cmake
index 6c59532d8..92814390c 100644
--- a/cmake/cpp.cmake
+++ b/cmake/cpp.cmake
@@ -65,6 +65,7 @@ if(USE_SCIP)
   if(NOT BUILD_SCIP)
     find_package(SCIP REQUIRED)
   endif()
+  set(SCIP_DEPS libscip)
 endif()
 
 if(USE_COINOR)
@@ -219,7 +220,7 @@ target_link_libraries(${PROJECT_NAME} PUBLIC
   gflags::gflags
   glog::glog
   protobuf::libprotobuf
-  libscip
+  ${SCIP_DEPS}
   ${COINOR_DEPS}
   ${CPLEX_DEP}
   ${XPRESS_DEP}
diff --git a/ortools/base/cleanup.h b/ortools/base/cleanup.h
index 41f3b6f39..80507f9f2 100644
--- a/ortools/base/cleanup.h
+++ b/ortools/base/cleanup.h
@@ -25,7 +25,7 @@ namespace cleanup_internal {
 
 template <typename Callback>
 class Storage {
-  using InvokeT = absl::base_internal::InvokeT<Callback>;
+  using InvokeT = absl::base_internal::invoke_result_t<Callback>;
   static_assert(std::is_same<InvokeT, void>::value, "");
   static_assert(!std::is_reference<Callback>::value, "");
 
-- 
2.28.0

